{
    "type": [
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        2,
        2,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2
    ],
    "data": [
        "\nR version 4.0.3 (2020-10-10) -- \"Bunny-Wunnies Freak Out\"\nCopyright (C) 2020 The R Foundation for Statistical Computing\nPlatform: x86_64-apple-darwin17.0 (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n\n  Natural language support but running in an English locale\n\nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n'citation()' on how to cite R or R packages in publications.\n\n",
        "Type 'demo()' for some demos, 'help()' for on-line help, or\n'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n\n[Workspace loaded from ~/Google Drive/University/Bicocca/Didattica/Computational Statistics/CompStat/.RData]\n\n",
        "> ",
        "library(survival)",
        "> ",
        "data(stanford2)",
        "Warning message:\n",
        "In data(stanford2) :",
        " data set ‘stanford2’ not found\n",
        "> ",
        "t <- stanford2$time # Survival times",
        "> ",
        "d <- stanford2$status # Censorship indicator",
        "> ",
        "",
        "> ",
        "# Kaplan-Meier estimate",
        "> ",
        "fit_KM <- survfit(Surv(t, d) ~ 1)",
        "> ",
        "plot(fit_KM)",
        "> ",
        "library(survival)",
        "> ",
        "data(\"stanford2\")",
        "Warning message:\n",
        "In data(\"stanford2\") :",
        " data set ‘stanford2’ not found\n",
        "> ",
        "library(survival)",
        "> ",
        "rm(list=ls())",
        "> ",
        "",
        "> ",
        "library(survival)",
        "> ",
        "t <- stanford2$time # Survival times",
        "> ",
        "d <- stanford2$status # Censorship indicator",
        "> ",
        "# Kaplan-Meier estimate",
        "> ",
        "fit_KM <- survfit(Surv(t, d) ~ 1)",
        "> ",
        "plot(fit_KM)",
        "> ",
        "survival::stanford2",
        "     id   time status age   t5\n139 139   86.0      1  12 1.26\n159 159   10.0      1  13 1.49\n181 181   60.0      0  13   NA\n119 119 1116.0      0  14 0.54\n74   74 2006.0      0  15 1.26\n120 120 1107.0      0  18 0.25\n99   99 1232.0      1  18 0.70\n108 108   42.0      1  19 0.63\n179 179   98.0      0  19   NA\n43   43  227.0      1  19 1.02\n134 134  793.0      0  19 1.98\n160 160    5.0      1  20   NA\n177 177  119.0      0  20   NA\n153 153  534.0      0  20   NA\n136 136  781.0      0  20 1.12\n133 133    1.0      1",
        "  21 0.47\n176 176  149.0      0  21   NA\n66   66 1634.0      1  23 1.78\n157 157  468.0      0  24 1.39\n114 114 1193.0      0  24 1.15\n46   46  631.0      1  26 1.46\n65   65 2313.0      0  26 0.46\n184 184    1.0      0  27   NA\n88   88   22.0      1  27 1.64\n182 182   56.0      0  27   NA\n180 180   89.0      0  27   NA\n163 163  391.0      0  27 1.17\n84   84 1778.0      0  27 0.70\n90   90    7.0      1  28 1.00\n68   68   48.0      1  28 0.77\n48   48   12.0      1  29 0.61\n174 174  176.0      0  29 1.72\n151 151",
        "  548.0      0  30 0.47\n125 125  993.0      0  30 0.95\n73   73 2025.0      0  30 1.44\n105 105  274.0      1  31 0.58\n117 117 1150.0      1  32 2.25\n96   96 1271.0      1  32 1.05\n39   39 2723.0      1  32 1.93\n38   38 2984.0      0  32 0.19\n106 106   31.0      1  33 0.36\n14   14 1961.0      1  33 1.06\n123 123   30.0      1  34 0.84\n135 135  328.0      1  34 1.02\n111 111 1262.0      0  34 1.68\n83   83   68.0      1  35 0.85\n143 143  221.0      1  35 1.04\n69   69 2127.0      1  35 0.67\n27   27   44.0      1  36",
        " 0.00\n113 113   47.0      1  36 0.16\n167 167  322.0      0  36 1.73\n156 156  382.0      1  36   NA\n141 141  663.0      0  36 0.47\n30   30 1478.0      1  36 1.35\n144 144   90.0      1  38 1.00\n158 158  464.0      0  38 2.07\n79   79  731.0      1  38 0.42\n102 102 1202.0      1  38   NA\n77   77 1945.0      0  38 1.28\n36   36 3021.0      0  38 0.98\n183 183    2.0      0  39   NA\n122 122  195.0      1  39 0.73\n162 162  406.0      0  39 1.18\n121 121 1102.0      0  39 1.35\n87   87 1718.0      0  39 1.77\n2     2    3.0",
        "      1  40 1.66\n64   64   14.0      1  40   NA\n150 150  549.0      0  40 2.53\n85   85 1722.0      0  40 0.95\n71   71 2106.0      0  40 0.86\n19   19 3695.0      0  40 0.38\n21   21    0.5      1  41 0.87\n175 175  138.0      1  41   NA\n169 169  278.0      0  41 0.98\n148 148  563.0      0  41   NA\n138 138  738.0      0  41 0.53\n98   98 1247.0      1  41 0.43\n104 104 1373.0      0  41 1.38\n103 103 1378.0      0  41 1.65\n12   12   39.0      1  42 1.38\n89   89   40.0      1  42 1.59\n3     3   46.0      1  42 0.61",
        "\n100 100  191.0      1  42 1.74\n55   55  297.0      1  42 0.60\n142 142  660.0      0  42 0.75\n63   63  161.0      1  43 1.20\n168 168  292.0      0  43 1.40\n72   72  293.0      1  43 0.70\n137 137  752.0      0  43 1.50\n10   10 1024.0      1  43 1.13\n124 124 1040.0      0  43 0.50\n17   17  836.0      1  44 1.58\n94   94 1534.0      1  44 1.71\n82   82 1846.0      0  44 0.83\n170 170   22.0      1  45   NA\n149 149   36.0      1  45 0.20\n42   42   65.0      1  45 1.68\n128 128  121.0      1  45   NA\n67   67  146.0      1",
        "  45 0.16\n109 109  381.0      1  45 0.98\n75   75 2000.0      0  45 1.46\n26   26 3410.0      0  45 0.98\n97   97   44.0      1  46 1.71\n58   58   50.0      1  46 2.25\n178 178  107.0      0  46   NA\n140 140  132.0      1  46 1.09\n32   32  897.0      1  46   NA\n126 126  950.0      0  46   NA\n51   51 1384.0      1  46 1.41\n101 101 1393.0      0  46 0.95\n29   29   51.0      1  47 1.38\n33   33  148.0      1  47   NA\n164 164  374.0      0  47   NA\n60   60  431.0      1  47 0.33\n152 152  541.0      0  47 0.43\n145 145",
        "  619.0      0  47 0.90\n112 112 1261.0      0  47 0.82\n76   76 1995.0      0  47 1.65\n47   47 2734.0      0  47 0.97\n118 118   45.0      1  48 0.65\n5     5  126.0      1  48 0.36\n129 129  202.0      1  48 1.24\n31   31  254.0      1  48 1.08\n35   35  323.0      1  48 1.82\n40   40  550.0      1  48 0.12\n130 130  841.0      0  48 0.86\n28   28  994.0      1  48 0.81\n56   56 1318.0      1  48 1.44\n91   91 1638.0      0  48 0.43\n44   44 2805.0      0  48 1.20\n23   23   54.0      1  49 2.09\n37   37   66.0      1  49",
        " 0.66\n70   70  263.0      1  49 0.48\n132 132  265.0      1  49 1.22\n9     9  279.0      1  49 1.12\n81   81  538.0      1  49 2.76\n59   59  547.0      1  49 0.81\n127 127  729.0      1  49 1.10\n131 131  834.0      0  49   NA\n80   80 1866.0      0  49 0.51\n20   20 1996.0      1  49 0.91\n25   25 2878.0      1  49 0.75\n165 165   50.0      1  50 0.50\n24   24   51.0      1  50   NA\n172 172  145.0      1  50 0.96\n146 146  618.0      0  50 0.82\n86   86  928.0      1  50 1.12\n107 107 1341.0      0  50 1.13\n95   95 1547.0",
        "      0  50 0.18\n116 116   48.0      1  51 0.99\n41   41   66.0      1  51 1.12\n61   61   68.0      1  51 1.33\n155 155  122.0      1  51 1.33\n166 166  139.0      1  51 0.96\n154 154  169.0      1  51 1.89\n4     4  623.0      1  51 1.32\n92   92 1612.0      0  51 1.25\n93   93   25.0      1  52 0.53\n62   62   26.0      1  52 0.82\n34   34   51.0      1  52 1.51\n15   15  136.0      1  52 1.62\n173 173  188.0      0  52   NA\n171 171  231.0      0  52   NA\n52   52  544.0      1  52 1.94\n110 110 1264.0      0  52 0.64",
        "\n50   50 2474.0      1  52 1.70\n45   45   25.0      1  53 1.68\n53   53   29.0      1  53 1.08\n54   54   48.0      1  53 3.05\n147 147  576.0      0  53 2.25\n115 115  626.0      1  53 1.74\n16   16    1.0      1  54 0.47\n1     1   15.0      1  54 1.11\n6     6   64.0      1  54 1.89\n7     7 1350.0      1  54 0.87\n57   57 1352.0      1  54 0.68\n78   78   65.0      1  55 0.69\n161 161  136.0      1  55   NA\n11   11   10.0      1  56 2.76\n8     8   23.0      1  56 2.05\n49   49   63.0      1  56 2.16\n13   13  730.0      1",
        "  58 0.96\n22   22   47.0      1  62 0.87\n18   18   60.0      1  64 0.69\n",
        "> ",
        "loglik_inaccurate <- function(t, d, alpha, beta) {",
        "+ ",
        "  hazard <- prod((alpha / beta * (t / beta)^(alpha - 1))^d)",
        "+ ",
        "  survival <- prod(exp(-(t / beta)^alpha))",
        "+ ",
        "  log(hazard * survival)",
        "+ ",
        "}",
        "> ",
        "loglik_inaccurate(t, d, alpha = 0.5, beta = 1000) # As it will be clear later on, these are likely values",
        "[1] -Inf\n",
        "> ",
        "# 1st inefficient implementation",
        "> ",
        "loglik_inefficient1 <- function(t, d, alpha, beta) {",
        "+ ",
        "  n <- length(t) # Sample size",
        "+ ",
        "  log_hazards <- numeric(n)",
        "+ ",
        "  log_survivals <- numeric(n)",
        "+ ",
        "",
        "+ ",
        "  for (i in 1:n) {",
        "+ ",
        "    log_hazards[i] <- d[i] * ((alpha - 1) * log(t[i] / beta) + log(alpha / beta))",
        "+ ",
        "    log_survivals[i] <- -(t[i] / beta)^alpha",
        "+ ",
        "  }",
        "+ ",
        "  sum(log_hazards) + sum(log_survivals)",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "# 2nd inefficient implementation",
        "> ",
        "loglik_inefficient2 <- function(t, d, alpha, beta) {",
        "+ ",
        "  n <- length(t) # Sample size",
        "+ ",
        "  log_hazards <- NULL",
        "+ ",
        "  log_survivals <- NULL",
        "+ ",
        "",
        "+ ",
        "  for (i in 1:n) {",
        "+ ",
        "    log_hazards <- c(log_hazards, d[i] * ((alpha - 1) * log(t[i] / beta) + log(alpha / beta)))",
        "+ ",
        "    log_survivals <- c(log_survivals, -(t[i] / beta)^alpha)",
        "+ ",
        "  }",
        "+ ",
        "  sum(log_hazards) + sum(log_survivals)",
        "+ ",
        "}",
        "> ",
        "loglik_inefficient1(t, d, alpha = 0.5, beta = 1000)",
        "[1] -873.3299\n",
        "> ",
        "loglik_inefficient2(t, d, alpha = 0.5, beta = 1000)",
        "[1] -873.3299\n",
        "> ",
        "# Efficient and numerically stable version",
        "> ",
        "loglik <- function(t, d, alpha, beta) {",
        "+ ",
        "  log_hazard <- sum(d * ((alpha - 1) * log(t / beta) + log(alpha / beta)))",
        "+ ",
        "  log_survival <- sum(-(t / beta)^alpha)",
        "+ ",
        "  log_hazard + log_survival",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "loglik(t, d, alpha = 0.5, beta = 1000)",
        "[1] -873.3299\n",
        "> ",
        "library(Rcpp)",
        "> ",
        "library(RcppArmadillo)",
        "> ",
        "Rcpp::sourceCpp('cpp/sum.cpp')",
        "In file included from sum.cpp:1:\nIn file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppArmadillo/include/RcppArmadillo.h:34:\nIn file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/Rcpp.h:57:\n/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/Rcpp/DataFrame.h:136:18: warning: unused variable 'data' [-Wunused-variable]\n",
        "            SEXP data = Parent::get__();\n                 ^\n",
        "1 warning generated.\n",
        "ld: warning: directory not found for option '-L/usr/local/gfortran/lib/gcc/x86_64-apple-darwin18/8.2.0'\n",
        "> ",
        "install.packages(\"Rcpp\", repos=\"https://rcppcore.github.io/drat\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "",
        "\nRestarting R session...\n\n",
        "> ",
        "install.packages(\"Rcpp\", repos = \"https://rcppcore.github.io/drat\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"Rcpp\", repos = \"https://rcppcore.github.io/drat\")",
        "Warning in install.packages :\n  unable to access index for repository https://rcppcore.github.io/drat/bin/macosx/contrib/4.0:\n  cannot open URL 'https://rcppcore.github.io/drat/bin/macosx/contrib/4.0/PACKAGES'\n",
        "Package which is only available in source form, and may need compilation of\n  C/C++/Fortran: ‘Rcpp’\n",
        "Do you want to attempt to install these from sources? (Yes/no/cancel) ",
        "Yes",
        "installing the source package ‘Rcpp’\n\n",
        "trying URL 'https://rcppcore.github.io/drat/src/contrib/Rcpp_1.0.6.7.tar.gz'\n",
        "Content type 'application/gzip'",
        " length 2898231 bytes (2.8 MB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 2.8 MB\n\n",
        "* installing *source* package ‘Rcpp’ ...\n",
        "** using staged installation\n",
        "** libs\n",
        "clang++ -mmacosx-version-min=10.13 -std=gnu++11 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG -I../inst/include/  -I/usr/local/include   -fPIC  -Wall -g -O2  -c api.cpp -o api.o\nclang++ -mmacosx-version-min=10.13 -std=gnu++11 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG -I../inst/include/  -I/usr/local/include   -fPIC  -Wall -g -O2  -c attributes.cpp -o attributes.o\nclang++ -mmacosx-version-min=10.13 -std=gnu++11 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG -I../inst/include/  -I/usr/local/include   -fPIC  -Wall -g -O2  -c barrier.cpp -o barrier.o\n",
        "clang++ -mmacosx-version-min=10.13 -std=gnu++11 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG -I../inst/include/  -I/usr/local/include   -fPIC  -Wall -g -O2  -c date.cpp -o date.o\nclang++ -mmacosx-version-min=10.13 -std=gnu++11 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG -I../inst/include/  -I/usr/local/include   -fPIC  -Wall -g -O2  -c module.cpp -o module.o\nclang++ -mmacosx-version-min=10.13 -std=gnu++11 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG -I../inst/include/  -I/usr/local/include   -fPIC  -Wall -g -O2  -c rcpp_init.cpp -o rcpp_init.o\n",
        "clang++ -mmacosx-version-min=10.13 -std=gnu++11 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/Library/Frameworks/R.framework/Resources/lib -L/usr/local/lib -o Rcpp.so api.o attributes.o barrier.o date.o module.o rcpp_init.o -F/Library/Frameworks/R.framework/.. -framework R -Wl,-framework -Wl,CoreFoundation\n",
        "installing to /Library/Frameworks/R.framework/Versions/4.0/Resources/library/00LOCK-Rcpp/00new/Rcpp/libs\n",
        "** R\n",
        "** inst\n",
        "** byte-compile and prepare package for lazy loading\n",
        "** help\n",
        "*** installing help indices\n",
        "** building package indices\n",
        "** installing vignettes\n",
        "** testing if installed package can be loaded from temporary location\n",
        "** checking absolute paths in shared objects and dynamic libraries\n",
        "** testing if installed package can be loaded from final location\n",
        "** testing if installed package keeps a record of temporary installation path\n",
        "* DONE (Rcpp)\n",
        "\n",
        "",
        "The downloaded source packages are in\n\t‘/private/var/folders/fx/_f2m8c1d0xd7mqykb5_gcqdr0000gn/T/Rtmp9Ydxp2/downloaded_packages’",
        "",
        "\n",
        "> ",
        "Rcpp::sourceCpp('cpp/sum.cpp')",
        "ld: warning: directory not found for option '-L/usr/local/gfortran/lib/gcc/x86_64-apple-darwin18/8.2.0'\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "x <- c(10, 20, 5, 30, 21, 78, pi, exp(7))",
        "> ",
        "arma_sum(x) # sum of the vector x",
        "Error in arma_sum(x) : \n  function 'Rcpp_precious_remove' not provided by package 'Rcpp'\n",
        "> ",
        "sum(x) # sum of the vector x - usual command",
        "[1] 1263.775\n",
        "> ",
        "Rcpp::sourceCpp('cpp/rnorm.cpp')",
        "> ",
        "set.seed(123)",
        "> ",
        "c(arma_rnorm(5, 0, 1)) # Rcpp implementation",
        "Error in arma_rnorm(5, 0, 1) : could not find function \"arma_rnorm\"\n",
        "> ",
        "",
        "> ",
        "set.seed(123)",
        "> ",
        "rnorm(5, 0, 1) # Usual R command",
        "[1] -0.56047565 -0.23017749  1.55870831  0.07050839  0.12928774\n",
        "> ",
        "Rcpp::sourceCpp('cpp/rnorm.cpp')",
        "> ",
        "Rcpp::sourceCpp('cpp/rnorm.cpp')",
        "ld: warning: directory not found for option '-L/usr/local/gfortran/lib/gcc/x86_64-apple-darwin18/8.2.0'\n",
        "> ",
        "set.seed(123)",
        "> ",
        "c(arma_rnorm(5, 0, 1)) # Rcpp implementation",
        "Error in arma_rnorm(5, 0, 1) : \n  function 'Rcpp_precious_remove' not provided by package 'Rcpp'\n",
        "> ",
        "",
        "> ",
        "set.seed(123)",
        "> ",
        "rnorm(5, 0, 1) # Usual R command",
        "[1] -0.56047565 -0.23017749  1.55870831  0.07050839  0.12928774\n",
        "> ",
        "rm(list=ls())",
        "\nRestarting R session...\n\n"
    ]
}